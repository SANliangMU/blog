<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>天嵌 E8 卡片电脑支持凯旋华触 21 寸电容屏 | 三刃丶木的个人博客</title>
<link rel="shortcut icon" href="https://sanliangmu.github.io/blog//favicon.ico?v=1637393635533">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.3.0/fonts/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://sanliangmu.github.io/blog//styles/main.css">
<link rel="alternate" type="application/atom+xml" title="天嵌 E8 卡片电脑支持凯旋华触 21 寸电容屏 | 三刃丶木的个人博客 - Atom Feed" href="https://sanliangmu.github.io/blog//atom.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">



    <meta name="description" content="准备条件

开发板：天嵌科技 E8 卡片电脑
触摸屏：凯旋华触 21 寸电容屏，分辨率为 1024 x 768

处理步骤
系统驱动支持 HID 设备
由于凯旋华触 21 寸电容屏触摸控制采用 HID 控制，所以需要系统支持 HID ，内核..." />
    <meta name="keywords" content="" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
    <script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://sanliangmu.github.io/blog/">
  <img class="avatar" src="https://sanliangmu.github.io/blog//images/avatar.png?v=1637393635533" alt="">
  </a>
  <h1 class="site-title">
    三刃丶木的个人博客
  </h1>
  <p class="site-description">
    温故而知新
  </p>
  <div class="menu-container">
    
      
        <a href="/" class="menu">
          首页
        </a>
      
    
      
        <a href="/archives" class="menu">
          归档
        </a>
      
    
      
        <a href="/tags" class="menu">
          标签
        </a>
      
    
      
        <a href="/post/about" class="menu">
          关于
        </a>
      
    
  </div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
</div>

        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              天嵌 E8 卡片电脑支持凯旋华触 21 寸电容屏
            </h2>
            <div class="post-info">
              <span>
                2021-11-20
              </span>
              <span>
                12 min read
              </span>
              
            </div>
            
            <div class="post-content-wrapper">
              <div class="post-content">
                <h1 id="准备条件">准备条件</h1>
<ol>
<li>开发板：天嵌科技 E8 卡片电脑</li>
<li>触摸屏：凯旋华触 21 寸电容屏，分辨率为 1024 x 768</li>
</ol>
<h1 id="处理步骤">处理步骤</h1>
<h2 id="系统驱动支持-hid-设备">系统驱动支持 HID 设备</h2>
<p>由于凯旋华触 21 寸电容屏触摸控制采用 HID 控制，所以需要系统支持 HID ，内核配置文件需要进行修改，改动处理步骤如下：</p>
<ol>
<li>执行指令<code>cp config_for_E8_Linux .config</code>，利用天嵌 E8 开发板自带的内核配置文件进行配置。</li>
<li>执行指令<code>make menuconfig</code>，在弹出的菜单配置项中进行如下选择：<pre><code class="language-SHELL">Device Drivers ---&gt;
    [*] HID Devices ---&gt;
        [*] /dev/hidraw raw HID device support
        &lt;*&gt; USB Human Interface Device (full HID) support
        [*] PID device support
        [*] /dev/hiddev raw HID device support
            Special HID drivers ---&gt;
</code></pre>
</li>
<li>利用指令<code>make zImage</code>生成内核镜像后烧写到开发板，重启后开发板就支持 HID 设备了。</li>
</ol>
<h2 id="编译驱动模块">编译驱动模块</h2>
<ol>
<li>在<code>drivers/hid/hid-ids.h</code>文件中查找触摸屏厂家 VID 和 PID 是否存在，不存在则添加到该文件。凯旋华触厂家的 VID 和 PID 为：<pre><code class="language-C">#define USB_VENDOR_ID_ILITEK 0x222a
#define USB_DEVICE_ID_ILITEK_MULTITOUCH 0x0001
</code></pre>
</li>
<li>在<code>drivers/hid/hid-core.c</code>文件中的<code>hid_have_special_driver[]</code>变量中查找触摸屏厂家 VID 和 PID (需要先在<code>hid-ids.h</code>文件中声明)，若没有则添加。<pre><code class="language-C">{ HID_USB_DEVICE(USB_VENDOR_ID_ILITEK, USB_DEVICE_ID_ILITEK_MULTITOUCH) },
</code></pre>
</li>
<li>在<code>drivers/hid/hid-multitouch.c</code>文件中的<code>mt_devices[]</code>变量中查找触摸屏厂家 VID 和 PID (需要先在<code>hid-ids.h</code>文件中声明)，若没有则添加。<pre><code class="language-C">{ .driver_data = MT_CLS_DEFAULT,
    HID_USB_DEVICE(USB_VENDOR_ID_ILITEK, USB_DEVICE_ID_ILITEK_MULTITOUCH) },
</code></pre>
</li>
<li>打开内核配置文件，进入到<code>Special HID drivers</code>(特定设备 HID 驱动配置) 项中，可以配置具体驱动为内核驱动、模块驱动或者不编译三种形式，厂家推荐编译成内核驱动<code>&lt;*&gt; HID Multitouch panels</code>，个人推荐编译成模块驱动<code>&lt;M&gt; HID Multitouch panels</code>，方便调试。</li>
<li>若编译成内核驱动，则执行指令<code>make zImage</code>生成内核镜像，然后烧写到开发板，重启后开发板则支持凯旋华触触摸屏。</li>
<li>若编译成模块驱动，则执行指令<code>make modules</code>生成模块驱动，需要将驱动下载至开发板，并配置环境文件使开发板能够开机安装驱动模块。驱动安装成功后即可支持凯旋华触触摸屏。<br>
配置操作为：<br>
在<code>/etc/init.d/rcS</code>文件末尾添加安装模块驱动指令<code>insmod 驱动文件所在目录/hid-multitouch.ko</code>。</li>
<li>开发板重启后插入凯旋华触触摸屏的 USB 控制线，驱动识别后会在<code>/dev</code>路径下生成对应的<code>event</code>文件、<code>hiddev</code>文件和<code>hidraw</code> 文件。</li>
<li>判断触摸屏触摸事件文件：利用<code>cat</code>指令，触摸触摸屏时，终端会打印新的信息。操作中判断<code>event</code>文件为触摸屏事件文件，驱动正常。</li>
</ol>
<h2 id="qte-框架支持电容屏">Qt/E 框架支持电容屏</h2>
<p>由于软件运行在 Qt 框架下，而电容屏支持需要 Qt4.7 及以上版本才提供支持，所以需要编译一个能够支持电容屏的 Qt/E 库，这里采用的版本是 Qt4.8.4 。具体的编译步骤如下：</p>
<ol>
<li>解压源码。</li>
<li>配置<code>configure</code>编译参数，推荐使用脚本进行。脚本内容如下：<pre><code class="language-SHELL">#!/bin/sh
echo &quot;Config Qt4.8.4 noew, please wait ...&quot;
./configure -opensource
    -embedded arm
    -xplatform qws/linux-arm-g++
    -no-webkit
    -qt-libtiff
    -qt-libmng
    -no-mouse-tslib
    -no-mouse-pc
    -no-mouse-linux-tp
    -no-mouse-qvfb
    -no-mouse-qnx
    -no-neon
    -qt-gfx-linuxfb
    -qt-gfx-transformed
    -nomake examples
    -nomake demos
    -qt-libjpeg
    -qt-libpng
    -qt-mouse-linuxinput
    -prefix /opt/qte_4.8
    -confirm-license
    -lrt
    -DQT_QLOCALE_USES_FACT &amp;&amp;
echo &quot;Finished config Qt4.8.4!&quot;
</code></pre>
</li>
<li>指令解释：<br>
<code>-DQT_QLOCALE_USES_FCVT</code> 支持浮点数功能，不添加可能出现浮点数运算有误问题<br>
<code>-lrt</code> 实时时钟运行库，不添加可能出现错误：<code>libQtCore.so: undefined reference to 'clock_gettime'</code><br>
<code>-confirm-license</code> 同意协议，不添加需要在配置过程中手动输入 yes 同意协议<br>
<code>-prefix</code> 安装目标位置(路径)<br>
<code>-qt-mouse-linuxinput</code> 支持电容屏输入控制必须配置该项，同时需要配置<code>-no-mouse-tslib</code>、<code>-no-mouse-tslib</code>、<code>-no-mouse-pc</code>、<code>-no-mouse-linux-tp</code>、<code>-no-mouse-qvfb</code>、<code>-no-mouse-qnx</code>。<br>
<code>-qt-libjped</code> 以 Qt 库形式编译 jpeg 库<br>
<code>-qt-libpng</code> 以 Qt 库形式编译 png 库<br>
<code>-qt-libmng</code> 以 Qt 库形式编译 mng 库<br>
<code>-qt-libtiff</code> 以 Qt 库形式编译 tiff 库<br>
<code>-nomake examples</code>、<code>-nomake demos</code> 不生成实例和演示<br>
<code>-qt-gfx-linuxfb</code> 使 Qt 程序图形输出为 Linux FrameBuffer<br>
<code>-qt-gfx-transformed</code> 使 Qt 程序能够旋转屏幕<br>
注意：指令都应该写在同一行！！！分开或者利用<code>\</code>连接有可能配置不成功。<br>
<code>&amp;&amp;</code> 表示只有当左侧指令执行无误后接着执行右侧指令。</li>
<li>利用指令<code>make &amp;&amp; make install</code>编译与安装生成库到配置路径，也可以直接将该指令写入配置脚本中，这样可以方便实现配置、编译、安装步骤。</li>
<li>从配置<code>-prefix</code>对应路径下压缩已经编译好的 Qt/E 库，然后将库下载到开发板，并配置对应的环境变量。<pre><code class="language-SHELL">export set QTDIR=/opt/qte_4.8
export set QPEDIR=/opt/qte_4.8
export set QWS_DISPLAY=&quot;LinuxFB:/dev/fb0&quot;
export set TSLIB_CALIBFILE=/etc/pointercal
export set TSLIB_CONSOLEDEVICE=none
export set QWS_MOUSE_PROTO=&quot;LinuxInput:/dev/event4&quot;
export set QT_PLUGIN_PATH=$QTDIR/plugins/
export set QT_QWS_FONTDIR=$QTDIR/lib/fonts/
export set PATH=$QPEDIR/bin:$PATH
export set LD_LIBRARY_PATH=$QTDIR/lib:$QPEDIR/plugins/imageformats:$QPEDIR/plugins/accessible:$LD_LIBRARY_PATH
</code></pre>
由于编译参数的原因，该 Qt/E 库仅可支持触摸屏触摸控制。</li>
<li>运行程序，进行触摸控制，测试编译库效果：发现触摸位置和鼠标位置不符，原因是没有进行触摸屏校正。</li>
<li>触摸屏校正方式：(1) 利用 Qt 的触摸屏校正程序进行校正。(2) 利用算法进行计算后将校正参数写入到文件<code>/ect/pointercal</code>文件。</li>
</ol>
<h1 id="触摸屏校准参数计算原理">触摸屏校准参数计算原理</h1>
<p>触摸屏校正算法可以通过 Qt 源码获得：</p>
<ol>
<li>文件<code>/src/gui/embedded/qmouselinuxinput_qws.cpp</code>中的<code>readMouseData</code> 函数获取 input 子系统传递的坐标值。由于触摸屏传递的触摸事件<code>EV_ABS</code>中，传递的<code>code</code>类型中有<code>ABS_PRESSURE</code> 项，默认处理项仅有<code>ABS_X</code>、<code>ABS_Y</code>，所以会打印警告信息。<pre><code class="language-C/C++">bool unknown = false;
if (data-&gt;type == EV_ABS) {
   if (data-&gt;code == ABS_X) {
        m_x = data-&gt;value;
    } else if (data-&gt;code == ABS_Y) {
        m_y = data-&gt;value;
    } else {
        unknown = true;
    }
} else ……
</code></pre>
若不想打印警告信息，可以将<code>unknown = true;</code>修改为 <code>unknown = false;</code>。</li>
<li>当触摸事件为<code>EV_SYN</code>与<code>SYN_REPORT</code>类型时，开始处理触摸事件：<pre><code class="language-C/C++">} else if (data-&gt;type == EV_SYN &amp;&amp; data-&gt;code == SYN_REPORT) {
    QPoint pos(m_x, m_y);
    pos = m_handler-&gt;transform(pos);
    m_handler-&gt;limitToScreen(pos);
    m_handler-&gt;mouseChanged(pos, m_buttons);
} else ……
</code></pre>
<code>transform</code>函数将触摸坐标点转换为屏幕坐标，跳转后得到处理代码如下所示：<pre><code class="language-C/C++">QPoint QWSCalibratedMouseHandler::transform(const QPoint &amp;position)
{
    QPoint tp;
    tp.setX((a * position.x() + b * position.y() + c) / s);
    tp.setY((d * position.x() + e * position.y() + f) / s);
    return tp;
}
</code></pre>
由此返回的 tp 正是屏幕坐标，<code>mouseChanged</code>函数将鼠标符号移动到 tp 点位置。</li>
<li>通过以下代码获取触摸屏的坐标限制：<pre><code class="language-C/C++">#include &lt;stdio.h&gt;
#include &lt;unistd.h&gt;
#include &lt;sys/ioctl.h&gt;
#include &lt;fcntl.h&gt;
#include &lt;errno.h&gt;
#include &lt;linux/input.h&gt;

int main(int argc, char *argv[])
{
    struct input_absinfo i_absInfo;
    if (argc &lt;= 1) {
        printf(&quot;Usage:%s dest\n&quot;, argv[0]);
        return -1;
    }

    // 打开输入设备
    int fd = open(argv[1], O_RDONLY);
    if (fd &lt; 0) {
        perror(argc[1]);
        return -1;
    }
    printf(&quot;You open the device: %s\n&quot;, argv[1]);

    // 得到 X 轴的 ABS 信息
    ioctl(fd, EVIOCGABS(ABS_X), &amp;i_absInfo);
    printf(&quot;X ABS Lastest Value = %d\n&quot;, i_absInfo.value);
    printf(&quot;\tX ABS Min Value = %d\n&quot;, i_absInfo.minimum);
    printf(&quot;\tX ABS Max Value = %d\n&quot;, i_absInfo.maximum);

    // 得到 Y 轴的 ABS 信息
    ioctl(fd, EVIOCGABS(ABS_Y), &amp;i_absInfo);
    printf(&quot;Y ABS Lastest Value = %d\n&quot;, i_absInfo.value);
    printf(&quot;\tY ABS Min Value = %d\n&quot;, i_absInfo.minimum);
    printf(&quot;\tY ABS Max Value = %d\n&quot;, i_absInfo.maximum);    

    // 得到 PRESSURE 轴的 ABS 信息
    ioctl(fd, EVIOCGABS(ABS_PRESSURE), &amp;i_absInfo);
    printf(&quot;PRESSURE ABS Lastest Value = %d\n&quot;, i_absInfo.value);
    printf(&quot;\tPRESSURE ABS Min Value = %d\n&quot;, i_absInfo.minimum);
    printf(&quot;\tPRESSURE ABS Max Value = %d\n&quot;, i_absInfo.maximum);

    // 得到触摸 X 轴的 ABS 信息
    ioctl(fd, EVIOCGABS(ABS_MT_POSITION_X), &amp;i_absInfo);
    printf(&quot;MT_POSITION_X ABS Lastest Value = %d\n&quot;, i_absInfo.value);
    printf(&quot;\tMT_POSITION_X ABS Min Value = %d\n&quot;, i_absInfo.minimum);
    printf(&quot;\tMT_POSITION_X ABS Max Value = %d\n&quot;, i_absInfo.maximum);

    // 得到触摸 Y 轴的 ABS 信息
    ioctl(fd, EVIOCGABS(ABS_MT_POSITION_Y), &amp;i_absInfo);
    printf(&quot;MT_POSITION_Y ABS Lastest Value = %d\n&quot;, i_absInfo.value);
    printf(&quot;\tMT_POSITION_Y ABS Min Value = %d\n&quot;, i_absInfo.minimum);
    printf(&quot;\tMT_POSITION_Y ABS Max Value = %d\n&quot;, i_absInfo.maximum);    

    // 得到触摸 PRESSURE 轴的 ABS 信息
    ioctl(fd, EVIOCGABS(ABS_MT_POSITION_PRESSURE), &amp;i_absInfo);
    printf(&quot;MT_POSITION_PRESSURE ABS Lastest Value = %d\n&quot;, i_absInfo.value);
    printf(&quot;\tMT_POSITION_PRESSURE ABS Min Value = %d\n&quot;, i_absInfo.minimum);
    printf(&quot;\tMT_POSITION_PRESSURE ABS Max Value = %d\n&quot;, i_absInfo.maximum);

    // 关闭设备
    close(fd);
    return 0;
}
</code></pre>
</li>
<li>根据程序获取坐标限制：X 轴触摸值限制为 0 ~ 65536 ， Y 轴触摸值限制为 0 ~ 9600 。又已知屏幕分辨率为 1024 x 768 ，可得公式如下所示：<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi>t</mi><mi>o</mi><mi>u</mi><mi>c</mi><mi>h</mi><mi>X</mi></mrow><mn>65536</mn></mfrac><mo>=</mo><mfrac><mrow><mi>s</mi><mi>c</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>n</mi><mi>X</mi></mrow><mn>1024</mn></mfrac><mi mathvariant="normal">，</mi><mfrac><mrow><mi>t</mi><mi>o</mi><mi>u</mi><mi>c</mi><mi>h</mi><mi>Y</mi></mrow><mn>9600</mn></mfrac><mo>=</mo><mfrac><mrow><mi>s</mi><mi>c</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>n</mi><mi>Y</mi></mrow><mn>768</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{touchX}{65536} = \frac{screenX}{1024}，\frac{touchY}{9600} = \frac{screenY}{768}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span><span class="mord">5</span><span class="mord">5</span><span class="mord">3</span><span class="mord">6</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">0</span><span class="mord">2</span><span class="mord">4</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord cjk_fallback">，</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">9</span><span class="mord">6</span><span class="mord">0</span><span class="mord">0</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.04633em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">7</span><span class="mord">6</span><span class="mord">8</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
又得：<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mi>c</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>n</mi><mi>X</mi><mo>=</mo><mfrac><mrow><mi>a</mi><mo>×</mo><mi>t</mi><mi>o</mi><mi>u</mi><mi>c</mi><mi>h</mi><mi>X</mi><mo>+</mo><mi>b</mi><mo>×</mo><mi>t</mi><mi>o</mi><mi>u</mi><mi>c</mi><mi>h</mi><mi>Y</mi><mo>+</mo><mi>c</mi></mrow><mi>s</mi></mfrac></mrow><annotation encoding="application/x-tex">screenX = \frac{a \times touchX + b \times touchY + c}{s}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">s</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mi>c</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>n</mi><mi>Y</mi><mo>=</mo><mfrac><mrow><mi>d</mi><mo>×</mo><mi>t</mi><mi>o</mi><mi>u</mi><mi>c</mi><mi>h</mi><mi>X</mi><mo>+</mo><mi>e</mi><mo>×</mo><mi>t</mi><mi>o</mi><mi>u</mi><mi>c</mi><mi>h</mi><mi>Y</mi><mo>+</mo><mi>f</mi></mrow><mi>s</mi></mfrac></mrow><annotation encoding="application/x-tex">screenY = \frac{d \times touchX + e \times touchY + f}{s}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.0574399999999997em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">s</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
为方便计算，使<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi><mo>=</mo><mi>c</mi><mo>=</mo><mi>d</mi><mo>=</mo><mi>f</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">b = c = d = f = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>则可得：<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mi>c</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>n</mi><mi>X</mi><mo>=</mo><mfrac><mrow><mi>a</mi><mo>×</mo><mi>t</mi><mi>o</mi><mi>u</mi><mi>c</mi><mi>h</mi><mi>X</mi></mrow><mi>s</mi></mfrac><mo>=</mo><mfrac><mrow><mn>1024</mn><mo>×</mo><mi>t</mi><mi>o</mi><mi>u</mi><mi>c</mi><mi>h</mi><mi>X</mi></mrow><mn>65536</mn></mfrac></mrow><annotation encoding="application/x-tex">screenX = \frac{a \times touchX}{s} = \frac{1024 \times touchX}{65536}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">s</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span><span class="mord">5</span><span class="mord">5</span><span class="mord">3</span><span class="mord">6</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">0</span><span class="mord">2</span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mi>c</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>n</mi><mi>Y</mi><mo>=</mo><mfrac><mrow><mi>d</mi><mo>×</mo><mi>t</mi><mi>o</mi><mi>u</mi><mi>c</mi><mi>h</mi><mi>Y</mi></mrow><mi>s</mi></mfrac><mo>=</mo><mfrac><mrow><mn>768</mn><mo>×</mo><mi>t</mi><mi>o</mi><mi>u</mi><mi>c</mi><mi>h</mi><mi>Y</mi></mrow><mn>9600</mn></mfrac></mrow><annotation encoding="application/x-tex">screenY = \frac{d \times touchY}{s} = \frac{768 \times touchY}{9600}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">s</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">9</span><span class="mord">6</span><span class="mord">0</span><span class="mord">0</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">7</span><span class="mord">6</span><span class="mord">8</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
由于 s 值唯一，且触摸值存在最大限值，则可使 s 的值为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>65536</mn><mo>×</mo><mn>9600</mn></mrow><annotation encoding="application/x-tex">65536 \times 9600</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">6</span><span class="mord">5</span><span class="mord">5</span><span class="mord">3</span><span class="mord">6</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">9</span><span class="mord">6</span><span class="mord">0</span><span class="mord">0</span></span></span></span>。则可得：<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mi>c</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>n</mi><mi>X</mi><mo>=</mo><mfrac><mrow><mn>1024</mn><mo>×</mo><mn>9600</mn><mo>×</mo><mi>t</mi><mi>o</mi><mi>u</mi><mi>c</mi><mi>h</mi><mi>X</mi></mrow><mrow><mn>65536</mn><mo>×</mo><mn>9600</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">screenX = \frac{1024 \times 9600 \times touchX}{65536 \times 9600}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.14077em;vertical-align:-0.7693300000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span><span class="mord">5</span><span class="mord">5</span><span class="mord">3</span><span class="mord">6</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">9</span><span class="mord">6</span><span class="mord">0</span><span class="mord">0</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">0</span><span class="mord">2</span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">9</span><span class="mord">6</span><span class="mord">0</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693300000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mi>c</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>n</mi><mi>X</mi><mo>=</mo><mfrac><mrow><mn>768</mn><mo>×</mo><mn>65536</mn><mo>×</mo><mi>t</mi><mi>o</mi><mi>u</mi><mi>c</mi><mi>h</mi><mi>Y</mi></mrow><mrow><mn>65536</mn><mo>×</mo><mn>9600</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">screenX = \frac{768 \times 65536 \times touchY}{65536 \times 9600}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.14077em;vertical-align:-0.7693300000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span><span class="mord">5</span><span class="mord">5</span><span class="mord">3</span><span class="mord">6</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">9</span><span class="mord">6</span><span class="mord">0</span><span class="mord">0</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">7</span><span class="mord">6</span><span class="mord">8</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">6</span><span class="mord">5</span><span class="mord">5</span><span class="mord">3</span><span class="mord">6</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693300000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
通过求取最小公约数后可得<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mo>=</mo><mn>75</mn><mo separator="true">,</mo><mi>b</mi><mo>=</mo><mn>0</mn><mo separator="true">,</mo><mi>c</mi><mo>=</mo><mn>0</mn><mo separator="true">,</mo><mi>d</mi><mo>=</mo><mn>0</mn><mo separator="true">,</mo><mi>e</mi><mo>=</mo><mn>384</mn><mo separator="true">,</mo><mi>f</mi><mo>=</mo><mn>0</mn><mo separator="true">,</mo><mi>s</mi><mo>=</mo><mn>4800</mn></mrow><annotation encoding="application/x-tex">a = 75, b = 0, c = 0, d = 0, e = 384, f = 0, s = 4800</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">7</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">3</span><span class="mord">8</span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span><span class="mord">8</span><span class="mord">0</span><span class="mord">0</span></span></span></span></li>
<li>通过计算后得到校准参数<code>75 0 0 0 384 0 4800</code>并写入到文件<code>/etc/pointercal</code>，重新进行触摸控制调试。</li>
<li>测试发现：触摸屏幕在左边四分之一时，鼠标符号已经移动到最右边，所以需要对 a 值进行调整，由于参数需求整数，所以先尝试将 a 值增大到 300 ，调整后重新尝试，可以准确控制触摸位置，则调试结束。</li>
<li>计算步骤可能存在问题，但由于后续没有再处理相关的问题了，这里暂时记下曾经的处理，方便回顾。</li>
</ol>
<h1 id="参考资料">参考资料</h1>
<p><a href="https://blog.csdn.net/laohuang1122/article/details/8313578">Qt4.7.0 使用电容屏</a><br>
<a href="https://blog.csdn.net/aifei7320/article/details/45869181">Qt-4.8.4使用电容触摸屏</a><br>
更多资料……</p>

              </div>
              <div class="toc-container">
                <ul class="markdownIt-TOC">
<li><a href="#%E5%87%86%E5%A4%87%E6%9D%A1%E4%BB%B6">准备条件</a></li>
<li><a href="#%E5%A4%84%E7%90%86%E6%AD%A5%E9%AA%A4">处理步骤</a>
<ul>
<li><a href="#%E7%B3%BB%E7%BB%9F%E9%A9%B1%E5%8A%A8%E6%94%AF%E6%8C%81-hid-%E8%AE%BE%E5%A4%87">系统驱动支持 HID 设备</a></li>
<li><a href="#%E7%BC%96%E8%AF%91%E9%A9%B1%E5%8A%A8%E6%A8%A1%E5%9D%97">编译驱动模块</a></li>
<li><a href="#qte-%E6%A1%86%E6%9E%B6%E6%94%AF%E6%8C%81%E7%94%B5%E5%AE%B9%E5%B1%8F">Qt/E 框架支持电容屏</a></li>
</ul>
</li>
<li><a href="#%E8%A7%A6%E6%91%B8%E5%B1%8F%E6%A0%A1%E5%87%86%E5%8F%82%E6%95%B0%E8%AE%A1%E7%AE%97%E5%8E%9F%E7%90%86">触摸屏校准参数计算原理</a></li>
<li><a href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99">参考资料</a></li>
</ul>

              </div>
            </div>
          </article>
        </div>

        
          <div class="next-post">
            <div class="next">下一篇</div>
            <a href="https://sanliangmu.github.io/blog/post/hello-gridea/">
              <h3 class="post-title">
                Hello Gridea
              </h3>
            </a>
          </div>
        

        

        <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
  <a class="rss" href="https://sanliangmu.github.io/blog//atom.xml" target="_blank">
    <i class="ri-rss-line"></i> RSS
  </a>
</div>

      </div>
    </div>

    <script>
      hljs.initHighlightingOnLoad()

      let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

      // This should probably be throttled.
      // Especially because it triggers during smooth scrolling.
      // https://lodash.com/docs/4.17.10#throttle
      // You could do like...
      // window.addEventListener("scroll", () => {
      //    _.throttle(doThatStuff, 100);
      // });
      // Only not doing it here to keep this Pen dependency-free.

      window.addEventListener("scroll", event => {
        let fromTop = window.scrollY;

        mainNavLinks.forEach((link, index) => {
          let section = document.getElementById(decodeURI(link.hash).substring(1));
          let nextSection = null
          if (mainNavLinks[index + 1]) {
            nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
          }
          if (section.offsetTop <= fromTop) {
            if (nextSection) {
              if (nextSection.offsetTop > fromTop) {
                link.classList.add("current");
              } else {
                link.classList.remove("current");    
              }
            } else {
              link.classList.add("current");
            }
          } else {
            link.classList.remove("current");
          }
        });
      });

    </script>
  </body>
</html>
